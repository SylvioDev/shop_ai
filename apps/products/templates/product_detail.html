{% extends "base.html" %}

{% block title %} Product detail {% endblock title%}

{% block content %}

<nav class="navbar  navbar-expand-lg navbar-light bg-white px-8 py-3 shadow-sm fixed-top">
    <div class="container-fluid">
      <!-- Brand -->
      
      <!-- Search bar -->
      <form class="d-flex flex-grow-1 me-3" role="search">
        <a class="navbar-brand" href="{% url 'products' %}">
          <small>SHOP AI</small>
        </a>
           
    
        <input class="form-control me-3" id="search-bar" style="border-radius:50px" type="search" placeholder="Search products ..." aria-label="Search">
        <button class="btn btn-warning" style="color:white" type="submit"><i class="bi bi-search"></i></button>
      
      </form>
  
      <div class="ms-auto d-flex align-items-center mt-3 mt-lg-0" id="cart-container">
        {% if not user.is_authenticated %}
            <a href="{% url 'login' %}" class="me-3 text-dark text-decoration-none"><i class="bi bi-box-arrow-right"></i> Log in</a>
        {% endif %}
  
        <a href="{% url 'cart' %}" class="position-relative me-3">
          <i class="bi bi-cart fs-4 text-dark"></i>
          <span id="cart-items" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning">
            {{ count }}
            <span class="visually-hidden"></span>
          </span>
        </a>
        
        
        
        {% if user.is_authenticated %}
       
            <!-- Profil avec dropdown -->
  
            <div class="dropdown">
              {% if user.userprofile.profile_picture %}
              <img src="{{ user.userprofile.profile_picture.url }}" alt="Profile Picture" class="profile-pic" data-bs-toggle="dropdown" aria-expanded="false" />
              {% else %}
              <img 
                  src="https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse1.mm.bing.net%2Fth%2Fid%2FOIP.PKlD9uuBX0m4S8cViqXZHAHaHa%3Fr%3D0%26pid%3DApi&f=1&ipt=d21b0bf7247a83a119e6d7e81a158c7613ca0d57822822d896676e1e229758ba&ipo=images"
                  alt="Profile Picture" 
                  class="profile-pic" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false" 
              />
              {% endif %}
  
              <ul class="dropdown-menu dropdown-menu-end custom-dropdown">
                
                <li>
                  <a class="dropdown-item" href="#">
                    Hi {{user.username}}
                  </a>
                </li>
                
                <li>
                  <a class="dropdown-item" href="{% url 'profile' %}">
                    <span class="icon-wrapper bg-warning text-white"><i class="bi bi-person-fill"></i></span>
                    Profile
                  </a>
                </li>
                
                <li><hr class="dropdown-divider" /></li>
                
                <li>
                  <a class="dropdown-item text-danger" href="{% url 'logout' %}">
                    <span class="icon-wrapper bg-danger text-white"><i class="bi bi-power"></i></span>
                    Log out
                  </a>
                </li>
  
              </ul>
            </div>
            
  
            
        {% endif %}
  
  
      </div>
  
  
     
      
    </div>
  </nav>


<br>
<br>
<br>

<div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
        <div class="product-container">
            <div class="row">
                <!-- Image Carousel Section -->
                <div class="col-lg-6">
                    <div id="productCarousel" class="carousel slide" data-bs-ride="false">
                        <div class="carousel-inner">
                            
                            <div class="carousel-item active">
                                <img id="image-active" src="{{ product.images.first.image.url }}" class="d-block w-100" alt="Headphones Front View">
                            </div>
                            
                            {% for image in product.images.all %}
                                
                                <div class="carousel-item">
                                    <img src="{{ image.image.url }}"  class="d-block w-100" alt="Headphones Front View">
                                </div>

                            {% endfor %}

                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                            <i class="bi bi-chevron-left" aria-hidden="true"></i>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                            <i class="bi bi-chevron-right" aria-hidden="true"></i>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                    
                    <!-- Thumbnail Navigation -->
                    <div class="thumbnail-carousel" id="thumbnail-carousel img">
                        {% for image in product.images.all %}
                            <img src="{{ image.image.url }}" class="thumbnail active" data-bs-target="#productCarousel" data-bs-slide-to="0" alt="Front">
                        {% endfor %}
                    </div>

                                            <!-- Product Description -->
                        <div class="product-description">
                            <h5><i class="bi bi-info-circle me-2"></i>Product description </h5>
                            {{ product.description }}
                        </div>


                </div>

                <!-- Product Information Section -->
                <div class="col-lg-6">
                    <div class="product-info">
                        <!-- Category -->
                        <br>
                        <span class="product-category">{{ product.category.name }}</span>
                        
                        <!-- Product Title -->
                        <h1 id="product-title" class="product-title">{{ product.name }}</h1>
                        <input type="hidden" id="product-sku" value="{{ product.sku }}"/>

                        <!-- Rating -->
                        <div class="rating">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="bi fa-star-half-alt"></i>
                            </div>
                            <span class="rating-text">4.7 (324 reviews)</span>
                        </div>
                        
                        <!-- Price -->
                        <div id="product-price" class="product-price">
                            ${{ product.price }}        
                        </div>
                        
                        <strike id="old-price">
                            ${{ product.old_price }}
                        </strike>
                        <br>
                        <br>
                         
                        <!-- Stock Status -->
                        <div id="product-stock" class="stock-status in-stock">
                            <i class="fas fa-check-circle"></i>
                            {% if product.stock > 0 %}
                                <span id="stock">In Stock - {{ product.stock }} available</span>
                            {% else %}
                                <span id="stock" style="color:#f44336">Out of stock </span>
                            {% endif %}
                        </div>

                        <br>
                    
                    {% if variants %}
                    
                        <form id="form-variant" method="post">
                            <select class="form-select" id="variantSelect">
                                <option value="{{ product.sku }}">{{ product.name }}</option>
                                {% for variant in variants %}        
                                    <option value="{{ variant.sku }}">{{ variant }}</option>
                                {% endfor %}
                    
                            </select>
                        </form>
                    

                        <br>

                        
                        <!-- Current configuration -->
                            <div class="config-summary">
                                Variant Details :
                                <br>
                                <br>
                                <ul class="list-group" id="variant-list">
                                                                           
                                </ul>
                                <br>
                                
                            </div>
                    
                    {% endif %}
                            
                         <!-- Quantity Selector -->
                        
                        <div class="variant-selector">
                            <label class="variant-label">Quantity : </label>
                            <div class="quantity-selector">
                                <button class="quantity-btn" type="button" onclick="DecreaseQuantity(this)">-</button>
                                <input id="product-quantity" type="number" class="quantity-input" value="1" min="1">
                                <button class="quantity-btn" type="button" onclick="IncreaseQuantity(this)">+</button>
                            </div>
                        </div>

                        

                        <br>

                        <!-- Action Buttons -->
                        <div class="d-flex gap-1 mb-2">
                            {% if product.stock > 0 %}
                            <button id="add-to-cart" onclick="addToCart(this)" class="btn btn-primary btn-lg flex-fill">
                                Add to Cart <i class="bi bi-cart me-2"></i>
                            </button>
                            {% endif %}
                            <!--
                            <button class="btn btn-outline-secondary">
                                <i class="bi bi-heart"></i>
                            </button>
                            -->
                        </div>
                    
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
<br>
{% endblock content %}